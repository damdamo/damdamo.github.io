<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8"> <title>Damien Morard - Enjoy Programming (and even more...)</title> <meta http-equip="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="I share my passion about Computer Science and programming. You can find posts about my research, some tutorials in programming, or just sharing my knowledge. I particularly use the Swift language, created by Apple."> <link rel="stylesheet" href="/assets/css/main.css" /> <link rel="icon" href="/assets/img/favicon.ico" type="image/gif" sizes="16x16"> <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script> <script async defer src="https://buttons.github.io/buttons.js"></script> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet"> <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous"> <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous"> <!-- <script> (function(d, h, m){ var js, fjs = d.getElementsByTagName(h)[0]; if (d.getElementById(m)){return;} js = d.createElement(h); js.id = m; js.onload = function(){ window.makerWidgetComInit({ position: "right", widget: "ofeeof264otl2l5g-zspk40eq2gaomj2n-higi2qphmveubksi" })}; js.src = "https://makerwidget.com/js/embed.js"; fjs.parentNode.insertBefore(js, fjs) }(document, "script", "dhm")) </script> --> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <script> (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-7259836434848202", enable_page_level_ads: true }); </script> </head> <body> <div class="container-fluid"><header> <div class="col-lg-12"> <div class="row"> <div class="col-md-2 center"> <a href="/"> <img src="/assets/img/general/ma_tete.jpeg" class="profile-img"> </a> </div> <div class="col-md-4 center"> <h1 class="profile-name"> Damien Morard</h1> <p class="profile-bio"> Enjoy Programming (and even more...)</p> <p class="profile-links"> <a class="social-link" href="http://medium.com/@dmorard1"> <i class="fab fa-medium-m"></i> </a> <a class="social-link" href="http://github.com/damdamo"> <i class="fab fa-github"></i> </a> <a class="social-link" href="http://linkedin.com/in/damienmorard"> <i class="fab fa-linkedin-in"></i> </a> </p> </div> <div class="col-md-6 center"> <ul class="nav justify-content-end" id="navigation"> </ul> <ul class="nav justify-content-end" id="navigation"><li class="nav-item"> <a class="nav-link" href="/blog">Blog</a> </li><li class="nav-item"> <a class="nav-link" href="/contact">Contact Me</a> </li><li class="nav-item"> <a class="nav-link" href="/">About</a> </li><li class="nav-item"> <a class="nav-link" href="/publications">Publications</a> </li></ul></div> </div> </div> </header> <div class="col-lg-12"> <!-- Blog Post Breadcrumbs --><nav aria-label="breadcrumb" role="navigation"> <ol class="breadcrumb"> <li class="breadcrumb-item"> <a href="/blog">Blog</a> </li> <li class="breadcrumb-item"> <a href="/blog/categories">Categories</a> </li> <li class="breadcrumb-item active" aria-current="page">Closures, Partial application and currying (Part 1/2) (Swift)</li> </ol> </nav> <div class="row"> <div class="col-lg-8"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <!-- <h1 class="post-title" itemprop="name headline">Closures, Partial application and currying (Part 1/2) (Swift)</h1> --> <h4 class="post-meta">Introduction of closures</h4> <p class="post-summary">Posted by : <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <span itemprop="name">Damien</span> </span> at <time datetime="2019-08-13 00:00:00 +0000" itemprop="datePublished">Aug 13, 2019</time> </p> <span class="disqus-comment-count" data-disqus-identifier="/tutorial/2019/08/13/closure-en.html"></span> <div class="post-categories"> Category : <a href="/blog/categories/tutorial">tutorial</a> </div> </div> <div class="card-body" itemprop="articleBody"> <!-- <img class="card-img-top" src="/assets/img/blog/yoda_closures.jpg" alt=""> --> <br/> <br/> <h2 id="introduction">Introduction</h2> <p>Are you afraid by this title? Do not go away and take time to demystify these concepts, understanding how it works.</p> <h2 id="welcome-to-the-fantastic-world-of-closures">Welcome to the fantastic world of closures</h2> <p>Look at <a href="https://docs.swift.org/swift-book/LanguageGuide/Closures.html">Swift</a> documentation and what we have about closures.</p> <blockquote> <p>“Closures are self-contained blocks of functionality that can be passed around and used in your code.”</p> </blockquote> <p>Is not it like a toolbox? In this box, we could have the tools, use them to get/modify the result. This seems a bit general, however the documentation keeps going:</p> <blockquote> <p>“Closures can capture and store references to any constants and variables from the context in which they are defined.”</p> </blockquote> <p>I think we need to clarify some notions to have a better understanding of the theory. A closure is like an environment, a memory which keeps values that we have defined in. Variables are only known in the scope where you declared them. For instance:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">foo</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">let</span> <span class="nv">x</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="c1">// 3</span>
  <span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">// Use of unresolved identifier 'x'</span>
<span class="nf">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div></div> <p>In this example, we have a function “<em>foo</em>” which declare a variable a variable “<em>x</em>”. This variable is only known inside the function. When we get out, we do not know “<em>x</em>” anymore. We have the same behavior for a closure. Hence, we have variables, and functionalities that are just functions.</p> <p>Later, we will see more information about closures. For now, we focus on how we can use them in Swift.</p> <p>What is Swift tells us about the syntactic representation of closures?</p> <blockquote> <p>“Closure expression syntax has the following general form:”</p> </blockquote> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span> <span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">return</span> <span class="n">type</span> <span class="k">in</span>
    <span class="n">statements</span>
<span class="p">}</span>
</code></pre></div></div> <p>One of the main defaults which is difficult with closure is its syntax. We need to identify each component to understand how it works.</p> <p>Let’s take an example:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">clos</span> <span class="o">=</span> <span class="p">{(</span><span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="k">in</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">}</span>

<span class="c1">// Print 42</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">clos</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">22</span><span class="p">))</span>
</code></pre></div></div> <p>We can see a closure as a function without a name, calling from the variable which is bound to “<em>clos</em>”. Same as a function, closures have inputs, its type and the output type. The key word “<em>in</em>” replaces the separation between the signature and the body. The key word “<em>return</em>” is the same as usual. If you decide to call this closure, you can make it use the name “<em>clos</em>” as a function name. You add inputs and you are ready to go! You easily understand that we just make an addition, but there is nothing exciting.</p> <p>Let’s look at another example, using a closure in function inputs.</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">apply</span><span class="p">(</span><span class="n">_</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span><span class="n">_</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="p">(</span><span class="kt">Int</span><span class="p">,</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nf">op</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div> <p>The “<em>apply</em>” function takes two Integer and will apply an operation on them. Do you understand the signature “<em>op: (Int, Int) -&gt; Int</em> “? It means that the label “<em>op</em>” is waiting a function or a closure which takes two Integers as inputs and return an Integers. Just a coincidence (or not), our last closure has the same signature. So, we can call our function like this:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Retourne 42</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="n">clos</span><span class="p">))</span>
</code></pre></div></div> <p>Are you beginning to understand? We have a way to make it easier, without declaring the closure before:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="p">{(</span><span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="nv">y</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="k">in</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">})</span>
</code></pre></div></div> <p>Any functions/closures having the signature “<em>(Int, Int) -&gt; Int</em> “ can be used as a parameter for “<em>op</em>”.</p> <p>Do you want syntactics tips to help you? Let’s go !</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="p">{(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">in</span>
  <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">})</span>
</code></pre></div></div> <p>(Traduction en cours)</p> <p>Did you see that we omit type parameter? Why does it work so? Thanks to the type <a href="https://en.wikipedia.org/wiki/Type_inference">inference</a>! (Not a black magic) At the time we declared the function “<em>apply</em>”, Swift already know the waiting type, seeing that we gave them at the function declaration. Swift automatically makes the association, and it is wonderful no? However, we are far to see all the things that we can do again! Next!</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="p">{(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">in</span>
  <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="p">})</span>
</code></pre></div></div> <p>Does not need a return? Indeed, when there is any ambiguity about the return value, Swift understands that the operation “<em>x+y</em>” is just the return value. After the “<em>in</em>” parameter, you can add as many parameters as many codes as needed. It is not finished yet, we have a way to do better!</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="nv">op</span><span class="p">:</span> <span class="p">{</span><span class="nv">$0</span> <span class="o">+</span> <span class="nv">$1</span><span class="p">})</span>
</code></pre></div></div> <p>Have I been too far? Test from yourself and you will see that it works! In this piece of code, we do not distinguish the signature and the body of our closure. From the same principle of the type inference, Swift can guess what we are waiting. How can we get value parameters? “<em>$0</em> “ et “<em>$1</em> “ are generic names that Swift use by default, taking input values.</p> <p>Are you a bit lost? Take back the signature “<em>op: (Int, Int) -&gt; Int</em> “. Here “<em>$0</em>” is just the first Integer and “<em>$1</em>” the second. The order of input parameters corresponds to the order of the parameters in the signature function. Therefore, Swift has binding values with predefined names. Last syntactic thing before I left you with closures!</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">apply</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">22</span><span class="p">)</span> <span class="p">{</span><span class="nv">$0</span> <span class="o">+</span> <span class="nv">$1</span><span class="p">}</span>
</code></pre></div></div> <p>When the last parameter of your function is a closure, you can just call like this. Do not even need to give the parameter names, only need to write a closure between curly braces. All the last closures work with this syntax. Nevertheless, do not forget the readability of your code!</p> <p>This part is now ended, keep going on the next part of partial application!</p> <p><a href="../../../2019/08/15/partial-application-en.html">Partie 2: Partial application and currying</a></p> </div> <div id="disqus_thread"></div> </article> </div><div class="col-lg-4"> <div class="card"> <div class="card-header"> About Damien Morard </div> <div class="card-body text-dark"> <!-- Your Bio --> <p> Hey, my name is Damien. I am a PhD student at the University of Geneva and researcher in computer science. My research areas include semantics, modeling and verification. Currently, I am working on improving High-level Petri nets by adding a way to use functions as token. My goal is to reduce the semantic gap between an implementation and its model.</p> </div> </div> <div class="card"> <div class="card-header">Categories </div> <div class="card-body text-dark"> <div id="#personal"></div> <li class="tag-head"> <a href="/blog/categories/personal">personal</a> </li> <a name="personal"></a> <div id="#tutorial"></div> <li class="tag-head"> <a href="/blog/categories/tutorial">tutorial</a> </li> <a name="tutorial"></a> </div> </div> </div></div> <!-- End of row--> </div><footer> <p> Powered by<a href="https://devlopr.netlify.com/readme"> devlopr jekyll</a>. Hosted at <a href="https://pages.github.com">Github</a>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script> <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script> </div> </body> </html>
